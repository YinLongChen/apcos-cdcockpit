CREATE OR REPLACE VIEW V_ODS_DEVICE_CENTER_INFO AS SELECT '3' AS MODEL_ID, T.SERIAL_NUM, T.DEVICE_MAC, T.PRODUCT_CODE, DECODE(T.WHETHER_REGISTER, '1',T.CREATE_DATE) AS REGIST_TIME, T.DEVICE_NAME, T2.USER_CELLPHONE_NO, T2.USER_ADDRESS, T3.TYPE_NAME AS PRODUCT_CODE_NAME FROM PRO_PRODUCT T JOIN PRO_ACCOUNT T1 ON T.ACCOUNT = T1.BCCA_ACCOUNT AND T.WHETHER_REGISTER = '1' JOIN USER_USER T2 ON T1.CREATE_ID = T2.USER_ID JOIN PRO_PRODUCT_TYPE T3 ON T.PRODUCT_CODE = T3.PRODUCT_CODE CREATE OR REPLACE FORCE VIEW V_ODS_DEVICE_REPORT AS SELECT 'DEVICE_REPORT' AS MODEL_ID, T.SERIAL_NUM, T.ACCOUNT, T.CMD_NAME, T.CREATE_DATE AS REPORT_TIME, T1.DEVICE_NAME, T1.DEVICE_MAC, T2.TYPE_NAME AS PRODUCT_CODE_NAME, T.PRODUCT_CODE, 'POSITION' AS POSITION, 'STATE' AS STATE, 'SPARE' AS SPARE FROM PRO_REPORT T LEFT JOIN PRO_PRODUCT T1 ON T.SERIAL_NUM = T1.SERIAL_NUM LEFT JOIN PRO_PRODUCT_TYPE T2 ON T.PRODUCT_CODE = T2.PRODUCT_CODE CREATE OR REPLACE FORCE VIEW V_ODS_USER_CENTER_INFO AS SELECT T.USER_ID, T.USER_NAME, T.USER_CARD_ID AS ID_CARD, CEIL(MONTHS_BETWEEN(SYSDATE, TO_DATE(SUBSTR(T.USER_CARD_ID, 7, 8), 'yyyymmdd')) / 12) AS AGE, DECODE(T.USER_GENDER, 1, '0', 2, '1') AS GENDER, T2.ORG_NAME AS DEPT, T.USER_CELLPHONE_NO AS USER_CELLPHONE_NO, T.USER_CREATED_TIME AS REGIST_TIME, T.USER_ADDRESS FROM USER_USER T LEFT JOIN USER_USER_ORG T1 ON T.USER_ID = T1.USER_ID LEFT JOIN USER_ORGANIZE T2 ON T1.ORG_ID = T2.ORG_ID CREATE OR REPLACE VIEW V_ODS_PRO_MODE AS SELECT ID, YMSID, MODE_NAME, ACCOUNT, ENABLE_MODE, AREA_CODE1, AREA_CODE2, AREA_CODE3, DETAIL_ADDRESS, MS_ORDER, CREATE_ID, CREATE_DATE, EDIT_ID, EDIT_DATE, MODE_README, '/product_mode/msControl' as MS_CONTROL FROM PRO_MODE T CREATE OR REPLACE VIEW V_ODS_ELECTRIC_CONSUMPTION AS SELECT to_date( CONCAT( BUSI_MONTH, '01 00:00:01' ), 'yyyy-MM-dd HH24:mi:ss' ) AS TIME, ENERGY_USAGE_TYPE as NAME, ENERGY_USAGE as VALUE, ENERGY_UNIT as UNIT, ENERGY_AREA_ID as ORG FROM ODS_ENERGY_USETYPE_DATA WHERE ENERGY_TYPE = '电' CREATE OR REPLACE VIEW V_ODS_WATER_CONSUMPTION AS SELECT to_date( CONCAT( BUSI_MONTH, '01 00:00:01' ), 'yyyy-MM-dd HH24:mi:ss' ) AS TIME, ENERGY_USAGE_TYPE as NAME, ENERGY_USAGE as VALUE, ENERGY_UNIT as UNIT, ENERGY_AREA_ID as ORG FROM ODS_ENERGY_USETYPE_DATA WHERE ENERGY_TYPE = '水' CREATE OR REPLACE VIEW V_ODS_ENERGY_COST AS SELECT nvl( T.WATER_AMOUNT, 0 ) AS WATER_AMOUNT, nvl( T.ELECTRIC_AMOUNT, 0 ) ELECTRIC_AMOUNT, nvl( T.WATER_AMOUNT, 0 ) + nvl( T.ELECTRIC_AMOUNT, 0 ) AS total, nvl( T.ETIME, T.WTIME ) AS TIME,nvl( T.EORG, T.WORG ) AS ORG FROM ( SELECT w.WATER_AMOUNT, e.ELECTRIC_AMOUNT, w.wtime, e.etime,w.WORG,e.EORG FROM (SELECT ENERGY_AMOUNT AS ELECTRIC_AMOUNT, BUSI_MONTH, to_date( CONCAT( BUSI_MONTH, '01' ), 'yyyy-MM-dd HH24:mi:ss' ) AS etime,ENERGY_AREA_ID as EORG FROM ODS_ENERGY_PAY_DATA WHERE ENERGY_TYPE = '电' ) e FULL OUTER JOIN (SELECT ENERGY_AMOUNT AS WATER_AMOUNT, BUSI_MONTH, to_date( CONCAT( BUSI_MONTH, '01' ), 'yyyy-MM-dd HH24:mi:ss' ) AS wtime,ENERGY_AREA_ID as WORG FROM ODS_ENERGY_PAY_DATA WHERE ENERGY_TYPE = '水' ) w ON e.BUSI_MONTH = w.BUSI_MONTH AND e.EORG=w.WORG ) T CREATE OR REPLACE VIEW V_ODS_ENERGY_ELECTRIC AS SELECT ENERGY_USAGE AS TOTAL, HUNMAN_NUM, AREAS, to_date(BUSI_DATE, 'yyyy-MM-dd HH24:mi:ss' ) AS time, ENERGY_AREA_ID as ORG FROM ODS_ENERGY_USAGE_DATA WHERE ENERGY_TYPE = '电' ORDER BY time CREATE OR REPLACE VIEW V_ODS_ENERGY_WATER AS SELECT ENERGY_USAGE AS TOTAL, HUNMAN_NUM, AREAS, to_date(BUSI_DATE, 'yyyy-MM-dd HH24:mi:ss' ) AS time, ENERGY_AREA_ID as ORG FROM ODS_ENERGY_USAGE_DATA WHERE ENERGY_TYPE = '水' ORDER BY time . Cause: org.apache.ibatis.jdbc.RuntimeSqlException: Line missing end-of-line terminator (;) => CREATE OR REPLACE VIEW V_ODS_DEVICE_CENTER_INFO AS SELECT '3' AS MODEL_ID, T.SERIAL_NUM, T.DEVICE_MAC, T.PRODUCT_CODE, DECODE(T.WHETHER_REGISTER, '1',T.CREATE_DATE) AS REGIST_TIME, T.DEVICE_NAME, T2.USER_CELLPHONE_NO, T2.USER_ADDRESS, T3.TYPE_NAME AS PRODUCT_CODE_NAME FROM PRO_PRODUCT T JOIN PRO_ACCOUNT T1 ON T.ACCOUNT = T1.BCCA_ACCOUNT AND T.WHETHER_REGISTER = '1' JOIN USER_USER T2 ON T1.CREATE_ID = T2.USER_ID JOIN PRO_PRODUCT_TYPE T3 ON T.PRODUCT_CODE = T3.PRODUCT_CODE CREATE OR REPLACE FORCE VIEW V_ODS_DEVICE_REPORT AS SELECT 'DEVICE_REPORT' AS MODEL_ID, T.SERIAL_NUM, T.ACCOUNT, T.CMD_NAME, T.CREATE_DATE AS REPORT_TIME, T1.DEVICE_NAME, T1.DEVICE_MAC, T2.TYPE_NAME AS PRODUCT_CODE_NAME, T.PRODUCT_CODE, 'POSITION' AS POSITION, 'STATE' AS STATE, 'SPARE' AS SPARE FROM PRO_REPORT T LEFT JOIN PRO_PRODUCT T1 ON T.SERIAL_NUM = T1.SERIAL_NUM LEFT JOIN PRO_PRODUCT_TYPE T2 ON T.PRODUCT_CODE = T2.PRODUCT_CODE CREATE OR REPLACE FORCE VIEW V_ODS_USER_CENTER_INFO AS SELECT T.USER_ID, T.USER_NAME, T.USER_CARD_ID AS ID_CARD, CEIL(MONTHS_BETWEEN(SYSDATE, TO_DATE(SUBSTR(T.USER_CARD_ID, 7, 8), 'yyyymmdd')) / 12) AS AGE, DECODE(T.USER_GENDER, 1, '0', 2, '1') AS GENDER, T2.ORG_NAME AS DEPT, T.USER_CELLPHONE_NO AS USER_CELLPHONE_NO, T.USER_CREATED_TIME AS REGIST_TIME, T.USER_ADDRESS FROM USER_USER T LEFT JOIN USER_USER_ORG T1 ON T.USER_ID = T1.USER_ID LEFT JOIN USER_ORGANIZE T2 ON T1.ORG_ID = T2.ORG_ID CREATE OR REPLACE VIEW V_ODS_PRO_MODE AS SELECT ID, YMSID, MODE_NAME, ACCOUNT, ENABLE_MODE, AREA_CODE1, AREA_CODE2, AREA_CODE3, DETAIL_ADDRESS, MS_ORDER, CREATE_ID, CREATE_DATE, EDIT_ID, EDIT_DATE, MODE_README, '/product_mode/msControl' as MS_CONTROL FROM PRO_MODE T CREATE OR REPLACE VIEW V_ODS_ELECTRIC_CONSUMPTION AS SELECT to_date( CONCAT( BUSI_MONTH, '01 00:00:01' ), 'yyyy-MM-dd HH24:mi:ss' ) AS TIME, ENERGY_USAGE_TYPE as NAME, ENERGY_USAGE as VALUE, ENERGY_UNIT as UNIT, ENERGY_AREA_ID as ORG FROM ODS_ENERGY_USETYPE_DATA WHERE ENERGY_TYPE = '电' CREATE OR REPLACE VIEW V_ODS_WATER_CONSUMPTION AS SELECT to_date( CONCAT( BUSI_MONTH, '01 00:00:01' ), 'yyyy-MM-dd HH24:mi:ss' ) AS TIME, ENERGY_USAGE_TYPE as NAME, ENERGY_USAGE as VALUE, ENERGY_UNIT as UNIT, ENERGY_AREA_ID as ORG FROM ODS_ENERGY_USETYPE_DATA WHERE ENERGY_TYPE = '水' CREATE OR REPLACE VIEW V_ODS_ENERGY_COST AS SELECT nvl( T.WATER_AMOUNT, 0 ) AS WATER_AMOUNT, nvl( T.ELECTRIC_AMOUNT, 0 ) ELECTRIC_AMOUNT, nvl( T.WATER_AMOUNT, 0 ) + nvl( T.ELECTRIC_AMOUNT, 0 ) AS total, nvl( T.ETIME, T.WTIME ) AS TIME,nvl( T.EORG, T.WORG ) AS ORG FROM ( SELECT w.WATER_AMOUNT, e.ELECTRIC_AMOUNT, w.wtime, e.etime,w.WORG,e.EORG FROM (SELECT ENERGY_AMOUNT AS ELECTRIC_AMOUNT, BUSI_MONTH, to_date( CONCAT( BUSI_MONTH, '01' ), 'yyyy-MM-dd HH24:mi:ss' ) AS etime,ENERGY_AREA_ID as EORG FROM ODS_ENERGY_PAY_DATA WHERE ENERGY_TYPE = '电' ) e FULL OUTER JOIN (SELECT ENERGY_AMOUNT AS WATER_AMOUNT, BUSI_MONTH, to_date( CONCAT( BUSI_MONTH, '01' ), 'yyyy-MM-dd HH24:mi:ss' ) AS wtime,ENERGY_AREA_ID as WORG FROM ODS_ENERGY_PAY_DATA WHERE ENERGY_TYPE = '水' ) w ON e.BUSI_MONTH = w.BUSI_MONTH AND e.EORG=w.WORG ) T CREATE OR REPLACE VIEW V_ODS_ENERGY_ELECTRIC AS SELECT ENERGY_USAGE AS TOTAL, HUNMAN_NUM, AREAS, to_date(BUSI_DATE, 'yyyy-MM-dd HH24:mi:ss' ) AS time, ENERGY_AREA_ID as ORG FROM ODS_ENERGY_USAGE_DATA WHERE ENERGY_TYPE = '电' ORDER BY time CREATE OR REPLACE VIEW V_ODS_ENERGY_WATER AS SELECT ENERGY_USAGE AS TOTAL, HUNMAN_NUM, AREAS, to_date(BUSI_DATE, 'yyyy-MM-dd HH24:mi:ss' ) AS time, ENERGY_AREA_ID as ORG FROM ODS_ENERGY_USAGE_DATA WHERE ENERGY_TYPE = '水' ORDER BY time